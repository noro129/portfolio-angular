<ng-container *ngFor="let appInstances of openedAplications | keyvalue : keepOrder; trackBy: trackByKey">
    <ng-container *ngFor="let instance of appInstances.value; trackBy: trackById">
        <ng-container [ngSwitch]="appInstances.key">

            <ng-container *ngSwitchCase="'bloDest'">
                <app-window [openInstance]="instance" [instanceType]="appInstances.key" [putFront]="putOpenInstanceFront" [removeOpenInstance]="removeOpenInstance">
                    <app-blodest class="application-body"/>
                </app-window>
            </ng-container>

            <ng-container *ngSwitchCase="'CMD'">
                <app-window [openInstance]="instance" [instanceType]="appInstances.key" [putFront]="putOpenInstanceFront" [removeOpenInstance]="removeOpenInstance">
                    <app-cmd class="application-body" [exit]="removeOpenInstance" [key1]="'CMD'" [key2]="instance.id" />
                </app-window>
            </ng-container>

            <ng-container *ngSwitchCase="AppType.Folder.toString()">
                <app-window [openInstance]="instance" [icon]="openedFolders.get(instance.id)?.icon" [instanceType]="appInstances.key" [putFront]="putOpenInstanceFront" [removeOpenInstance]="removeOpenInstance">
                    <app-folder [openedFolder]="openedFolders.get(instance.id)" [folder]="instance" class="application-body" [open]="open" [dragOver]="dragOver" [dropToMove]="dropToMove" [contentTreeStructure]="contentTreeStructure" [switchingToFolder]="switchingToFolder" [setDraggedId]="setDraggedId" [setDragSource]="setDragSource" [setDragDestination]="setDragDestination" [moveContentInTree]="moveContentInTree"/>
                </app-window>
            </ng-container>

            <ng-container *ngSwitchCase="'recycle bin'">
                <app-window [openInstance]="instance" [instanceType]="appInstances.key" [putFront]="putOpenInstanceFront" [removeOpenInstance]="removeOpenInstance">
                    <app-trash class="application-body" [deletedItems]="deletedItems" [restoreApp]="restoreApp" (dragover)="dragOver($event)" (drop)="dropToDelete($event)"/>
                </app-window>
            </ng-container>

            <ng-container *ngSwitchCase="'WhoAmI'">
                <app-window [openInstance]="instance" [instanceType]="appInstances.key" [putFront]="putOpenInstanceFront" [removeOpenInstance]="removeOpenInstance">
                    <app-whoami class="application-body"/>
                </app-window>
            </ng-container>

            <ng-container *ngSwitchDefault>
                <app-window [openInstance]="instance" [instanceType]="appInstances.key" [putFront]="putOpenInstanceFront" [removeOpenInstance]="removeOpenInstance">
                    @if(experience.has(instance.name)) {
                        <app-file-reader class="application-body" [experience]="experience.get(instance.name)" />
                    } @else {
                        <app-file-reader class="application-body" [script]="script.get(instance.name)" />
                    }
                    
                </app-window>
            </ng-container>
            
        </ng-container>
    </ng-container>
</ng-container>